# 📁 项目结构说明

```
youjiandingshi/                    # 项目根目录
│
├── server/                        # 后端服务
│   ├── config/                    # 配置文件
│   │   ├── database.js           # 数据库连接配置
│   │   └── init.sql              # 数据库初始化脚本
│   │
│   ├── routes/                    # 路由/接口
│   │   ├── smtp.js               # SMTP配置接口
│   │   ├── notifications.js      # 通知管理接口
│   │   └── logs.js               # 日志查询接口
│   │
│   ├── utils/                     # 工具函数
│   │   ├── mailer.js             # 邮件发送工具
│   │   └── scheduler.js          # 任务调度工具
│   │
│   ├── index.js                   # 后端入口文件
│   ├── package.json              # 后端依赖配置
│   ├── .env                      # 环境变量（需自己创建）
│   └── .env.example              # 环境变量示例
│
├── client/                        # 前端项目
│   ├── public/                    # 静态资源
│   │   └── logo.svg              # 网站图标
│   │
│   ├── src/                       # 源代码
│   │   ├── api/                   # API 接口封装
│   │   │   ├── smtp.js           # SMTP相关接口
│   │   │   ├── notification.js   # 通知相关接口
│   │   │   └── log.js            # 日志相关接口
│   │   │
│   │   ├── stores/                # 状态管理
│   │   │   └── theme.js          # 主题状态
│   │   │
│   │   ├── utils/                 # 工具函数
│   │   │   └── request.js        # HTTP请求封装
│   │   │
│   │   ├── views/                 # 页面组件
│   │   │   ├── Layout.vue        # 布局组件
│   │   │   ├── Dashboard.vue     # 首页概览
│   │   │   ├── Notifications.vue # 通知管理
│   │   │   ├── SmtpConfig.vue    # 邮箱配置
│   │   │   └── Logs.vue          # 发送记录
│   │   │
│   │   ├── router/                # 路由配置
│   │   │   └── index.js          # 路由定义
│   │   │
│   │   ├── App.vue               # 根组件
│   │   ├── main.js               # 前端入口
│   │   └── style.css             # 全局样式
│   │
│   ├── index.html                # HTML模板
│   ├── vite.config.js            # Vite配置
│   └── package.json              # 前端依赖配置
│
├── logs/                          # 日志目录（运行时生成）
│   ├── access.log                # Nginx访问日志
│   └── error.log                 # Nginx错误日志
│
├── README.md                      # 项目说明
├── 使用手册.md                     # 用户使用手册
├── 启动说明.md                     # 启动操作指南
├── 宝塔部署文档.md                 # 宝塔部署详细步骤
├── 项目结构说明.md                 # 本文档
├── nginx.conf                     # Nginx配置文件
├── .gitignore                    # Git忽略文件
└── package.json                   # 根目录配置
```

## 📝 文件说明

### 后端核心文件

#### `server/index.js`
- 后端主入口
- 初始化Express服务器
- 加载路由
- 启动任务调度器

#### `server/config/database.js`
- MySQL数据库连接池
- 数据库配置管理

#### `server/config/init.sql`
- 数据库表结构
- 初始化数据
- 首次部署时导入

#### `server/routes/smtp.js`
- SMTP配置的增删改查
- 测试SMTP连接
- 启用/禁用配置

#### `server/routes/notifications.js`
- 通知任务的增删改查
- 启动/停止任务
- 任务状态管理

#### `server/routes/logs.js`
- 发送日志查询
- 统计数据计算
- 日志清理

#### `server/utils/mailer.js`
- 邮件发送功能
- SMTP配置获取
- 邮件测试

#### `server/utils/scheduler.js`
- 任务调度核心
- Cron表达式生成
- 任务启动/停止
- 发送日志记录

### 前端核心文件

#### `client/src/main.js`
- 前端入口文件
- 初始化Vue应用
- 注册全局组件和插件

#### `client/src/App.vue`
- 根组件
- 主题初始化

#### `client/src/router/index.js`
- 路由配置
- 页面导航定义

#### `client/src/stores/theme.js`
- 主题状态管理（浅色/深色）
- 本地存储持久化

#### `client/src/utils/request.js`
- Axios封装
- 请求/响应拦截器
- 错误统一处理

#### `client/src/api/`
- API接口封装
- 分模块管理
- 便于维护

#### `client/src/views/Layout.vue`
- 整体布局
- 侧边栏菜单
- 顶部导航
- 主题切换

#### `client/src/views/Dashboard.vue`
- 首页概览
- 统计数据展示
- 快捷操作
- 使用说明

#### `client/src/views/Notifications.vue`
- 通知列表
- 创建/编辑通知
- 任务管理

#### `client/src/views/SmtpConfig.vue`
- SMTP配置列表
- 添加/编辑配置
- 测试连接

#### `client/src/views/Logs.vue`
- 发送记录列表
- 统计数据
- 日志筛选

### 配置文件

#### `server/.env`
- 环境变量
- 数据库配置
- 服务器端口
- **敏感信息，不要提交到Git**

#### `client/vite.config.js`
- Vite构建配置
- 开发服务器配置
- 代理配置

#### `nginx.conf`
- Nginx配置
- 反向代理
- 静态文件服务

#### `.gitignore`
- Git忽略规则
- 不提交的文件

### 文档文件

#### `README.md`
- 项目总览
- 快速开始
- 功能介绍

#### `使用手册.md`
- 面向最终用户
- 详细操作步骤
- 常见问题

#### `启动说明.md`
- 开发环境启动
- 生产环境部署
- 启动脚本

#### `宝塔部署文档.md`
- 宝塔面板部署
- 详细部署步骤
- 故障排除

## 🔧 技术架构

### 后端技术栈

- **Node.js** - JavaScript运行时
- **Express** - Web框架
- **MySQL2** - 数据库驱动
- **nodemailer** - 邮件发送
- **node-schedule** - 任务调度
- **dotenv** - 环境变量
- **cors** - 跨域支持

### 前端技术栈

- **Vue 3** - 前端框架
- **Vite** - 构建工具
- **Vue Router** - 路由管理
- **Pinia** - 状态管理
- **Element Plus** - UI组件库
- **Axios** - HTTP客户端

### 数据库设计

#### `smtp_config` - SMTP配置表
- 存储邮箱服务器配置
- 支持多个配置
- 同时只能启用一个

#### `notifications` - 通知任务表
- 存储通知任务信息
- 包含调度配置
- 记录执行状态

#### `send_logs` - 发送日志表
- 记录每次发送
- 成功/失败状态
- 错误信息

## 🚀 数据流程

### 1. 用户创建通知

```
用户填写表单
  ↓
前端验证数据
  ↓
发送到后端 API
  ↓
后端验证并存入数据库
  ↓
启动定时任务
  ↓
返回成功响应
```

### 2. 定时发送邮件

```
定时器触发
  ↓
执行通知任务
  ↓
获取SMTP配置
  ↓
发送邮件
  ↓
记录发送日志
  ↓
更新任务状态
```

### 3. 查看发送记录

```
用户请求记录
  ↓
后端查询数据库
  ↓
返回日志数据
  ↓
前端展示列表
```

## 📦 部署流程

### 开发环境

1. 安装依赖
2. 配置数据库
3. 启动后端（开发模式）
4. 启动前端（开发模式）
5. 访问 http://localhost:5173

### 生产环境（宝塔）

1. 上传代码
2. 安装依赖
3. 构建前端
4. 配置数据库
5. 使用PM2启动后端
6. 配置Nginx
7. 访问域名

## 🔐 安全说明

### 敏感信息

以下文件包含敏感信息，不应提交到Git：

- `server/.env` - 数据库密码
- `node_modules/` - 依赖包
- `dist/` - 构建输出

### 密码存储

- 数据库密码存储在 `.env` 文件
- SMTP密码存储在数据库（建议后期加密）
- 建议使用强密码

### 网络安全

- 后端端口不对外开放
- 通过Nginx反向代理
- 建议启用HTTPS

## 📊 性能优化

### 前端优化

- Gzip压缩
- 静态资源缓存
- 代码分割
- 懒加载

### 后端优化

- 数据库连接池
- 索引优化
- 日志定期清理

### 部署优化

- PM2集群模式
- Nginx负载均衡
- CDN加速（可选）

## 🤝 贡献指南

如需修改代码：

1. 了解项目结构
2. 遵循代码规范
3. 测试修改
4. 提交前检查

## 📞 支持

如有问题，请查看：

1. 本文档
2. 使用手册
3. 部署文档
4. 项目README

---

**项目结构清晰，便于维护和扩展** 🎯


