# 🚀 安装向导说明

## 功能概述

系统首次启动时会自动进入**安装向导页面**，引导用户完成初始化配置。

## 安装向导流程

### 步骤1: 环境检查 🔍

自动检测系统环境状态：
- ✅ **后端服务**：检查Node.js服务器是否正常运行
- ✅ **数据库连接**：检查MySQL数据库是否可访问
- ✅ **数据表**：检查必需的数据表是否已创建

**如果数据库未初始化**：
- 页面会显示初始化命令
- 一键复制命令到剪贴板
- 在命令行执行：`cd server && node import-complete-db.js`
- 刷新页面或点击"重新检查"

### 步骤2: 数据库配置 🗄️

测试和确认数据库连接：
- 填写数据库信息（主机、端口、用户名、密码等）
- 点击"测试连接"验证配置
- 连接成功后才能进入下一步

**配置项：**
```
数据库地址: localhost
端口: 3306
数据库名: notification_system
用户名: root
密码: [你的数据库密码]
```

### 步骤3: 管理员账号 👤

设置系统管理员账号：

**选项1 - 使用默认账号**（推荐快速开始）：
- 用户名：`admin`
- 密码：`admin123`
- ⚠️ **重要**：登录后请立即修改密码

**选项2 - 创建新账号**：
- 自定义用户名和密码
- 密码至少6位字符
- 可选填昵称和邮箱

### 步骤4: 完成 🎉

显示安装摘要和快速开始指南：
- 查看管理员账号信息
- 查看系统配置摘要
- 点击"立即登录"进入系统

## 自动检测逻辑

系统会自动判断是否需要安装：

1. **首次访问**（未完成安装）
   - 自动跳转到 `/install` 安装页面
   - 检查数据库中是否有用户数据

2. **已完成安装**
   - 直接访问登录页面 `/login`
   - 不再显示安装向导

3. **检测标识**
   - 本地存储标记：`localStorage.getItem('install_completed')`
   - 后端数据检查：`/api/install/status`

## 跳过安装向导

如果你已经手动完成了数据库初始化，可以跳过向导：

### 方法1: 设置本地标记
在浏览器控制台（F12）执行：
```javascript
localStorage.setItem('install_completed', 'true')
```
然后刷新页面即可直接访问登录页。

### 方法2: 直接访问登录页
如果数据库已初始化且有用户数据，直接访问：
```
http://localhost:5173/login
```

## 相关文件

### 前端
- **页面组件**：`client/src/views/Install.vue`
- **路由配置**：`client/src/router/index.js`

### 后端
- **安装API**：`server/routes/install.js`
- **服务器入口**：`server/index.js`（已注册安装路由）

## API接口

### 1. 检查系统环境
```http
GET /api/install/check
```
**响应**：
```json
{
  "success": true,
  "database": true,    // 数据库是否连接
  "tables": true       // 数据表是否存在
}
```

### 2. 测试数据库连接
```http
POST /api/install/test-db
Content-Type: application/json

{
  "host": "localhost",
  "port": 3306,
  "user": "root",
  "password": "your_password",
  "database": "notification_system"
}
```

### 3. 检查安装状态
```http
GET /api/install/status
```
**响应**：
```json
{
  "success": true,
  "installed": true    // 是否已安装
}
```

## 注意事项

1. **首次安装必须先初始化数据库**
   ```bash
   cd server
   node import-complete-db.js
   ```

2. **默认管理员账号安全**
   - 首次登录后立即修改密码
   - 在"个人中心"→"修改密码"

3. **安装完成后不可重置**
   - 如需重新安装，需要清空数据库和本地存储
   - 清除本地标记：`localStorage.removeItem('install_completed')`

4. **生产环境部署**
   - 修改前端路由守卫中的后端地址
   - 当前硬编码：`http://localhost:3000`
   - 建议改为环境变量或相对路径

## 界面特性

- ✅ **4步引导流程**：清晰的步骤指示器
- ✅ **实时状态检查**：自动检测环境配置
- ✅ **友好的错误提示**：明确的问题说明和解决方案
- ✅ **一键复制命令**：快速复制初始化命令
- ✅ **响应式设计**：适配各种屏幕尺寸
- ✅ **渐变背景**：美观的视觉效果
- ✅ **暗色模式支持**：自动适应主题

## 开发调试

### 重置安装状态
```javascript
// 浏览器控制台执行
localStorage.removeItem('install_completed')
location.reload()
```

### 强制进入安装页面
```javascript
// 直接访问
window.location.href = '/install'
```

### 查看当前安装状态
```javascript
console.log('Install completed:', localStorage.getItem('install_completed'))
```

## 常见问题

### Q: 无法进入安装页面？
A: 检查是否已设置 `install_completed` 标记，清除后刷新。

### Q: 环境检查一直失败？
A: 
1. 确认后端服务已启动（`cd server && npm run dev`）
2. 确认数据库服务运行正常
3. 检查 `.env` 文件配置是否正确

### Q: 跳过安装直接使用？
A: 手动执行数据库初始化后，设置本地标记即可。

### Q: 如何自定义安装流程？
A: 修改 `client/src/views/Install.vue` 组件和 `server/routes/install.js` 路由。

## 更新日志

- **v1.0.0** - 初始版本，包含4步安装向导
- 自动环境检测
- 数据库连接测试
- 管理员账号创建
- 安装完成引导

